## 重排序

重排序是指编译器和处理器为了优化程序性能而对指令序列进行重排序的一种手段。

### 数据依赖

如果两个操作访问同一个变量，且这两个操作中有一个为写操作，此时这两个操作之间就存在数据依赖性。数据依赖分为下列3种类型：

| 名称 | 代码示例 | 说明 |
| --- | --- | --- |
| 写后读 | a=1; b=a; | 写一个变量之后，再读这个变量。 | 
| 写后写 | a=1; a=2; | 写一个变量之后，再写这个变量。 |
| 读后写 | a=b; b=1; | 读一个变量之后，再写这个变量。 |

这3种情况只要重排序执行顺序，程序的执行结果就会改变。

编译器和处理器可能会对操作做重排序。在重排序时，会遵守数据依赖性，编译器和处理器不会改变存在数据依赖关系的两个操作的顺序。

这里所说的数据依赖性仅针对单个处理器中执行的指令序列和单个线程中执行的操作，不同处理器之间和不同线程之间的数据依赖性不被编译器和处理器考虑。

### as-if-serial语义


